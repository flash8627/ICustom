<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gwtjs.register.dao.IRegisterDAO">
	
	<select id="findItem" resultType="com.gwtjs.register.entity.RegisterVO">
		SELECT
		<include refid="Base_Column_List" />
		FROM SYS_REGISTER_T T1
		where VALID_FLAG=1 AND T1.REG_ID = #{regId,jdbcType=NUMERIC}
	</select>
	
	<select id="selectList" resultType="com.gwtjs.register.entity.RegisterVO">
		SELECT
		<include refid="Base_Column_List" />
		FROM SYS_REGISTER_T T1 
		where VALID_FLAG=1
		<include refid="select_cond" />
	</select>

	<select id="selectListCount"
		resultType="INTEGER">
		SELECT
		COUNT(1)
		FROM SYS_REGISTER_T T1 
		where VALID_FLAG=1 
		<include refid="select_cond" />
	</select>

	<sql id="select_cond">
		
		<!-- <if test='_parameter.get("0").parentId != null'>
			AND T1.PARENT_ID = #{0.parentId,jdbcType=NUMERIC}
		</if>

		<if test='_parameter.get("0").regCode != null'>
			AND T1.REG_CODE = #{0.regCode,jdbcType=VARCHAR}
		</if>

		<if test='_parameter.get("0").regValue != null'>
			AND T1.REG_VALUE = #{0.regValue,jdbcType=VARCHAR}
		</if>

		<if test='_parameter.get("0").regName != null'>
			AND T1.REG_NAME = #{0.regName,jdbcType=VARCHAR}
		</if>

		<if test='_parameter.get("0").regDesc != null'>
			AND T1.REG_DESC LIKE '%'|| #{0.regDesc,jdbcType=VARCHAR} ||'%'
		</if> -->

	</sql>

	<sql id="Base_Column_List">
		REG_ID regId,
		REG_NAME regName,
		REG_CODE regCode,
		REG_DESC regDesc,
		REG_VALUE regValue,
		PARENT_PATH,
		PARENT_ID,
		ORDER_CODE,
		CREATED_USER,
		CREATED_DATE,
		UPDATE_LAST_USER,
		UPDATE_LAST_DATE
	</sql>

	

	<!-- batch action -->

	<delete id="batchRemovePks" parameterType="java.util.List">
		DELETE FROM SYS_REGISTER_T WHERE REG_ID in
		<foreach item="item" index="index" collection="list" open="("
			separator="," close=")">
			#{item}
		</foreach>
	</delete>

	<!-- batchUpdate -->
	<update id="batchUpdate">
		declare
		<if test="list!=null and !list.isEmpty()">
			begin
			<foreach collection="list" item="item">
				UPDATE
				SYS_REGISTER_T
				set
				REG_NAME = #{item.regName,jdbcType=VARCHAR},
				REG_CODE = #{item.regCode,jdbcType=VARCHAR},
				REG_DESC = #{item.regDesc,jdbcType=VARCHAR},
				REG_VALUE = #{item.regValue,jdbcType=VARCHAR},
				PARENT_PATH = #{item.parentPath,jdbcType=VARCHAR},
				PARENT_ID = #{item.parentId,jdbcType=NUMERIC},
				ORDER_CODE = #{item.orderCode,jdbcType=INTEGER},
				UPDATE_LAST_USER = #{item.updateLastUser,jdbcType=NUMERIC},
				UPDATE_LAST_DATE = SYSDATE
				where REG_ID = #{regId,jdbcType=NUMERIC};
			</foreach>
		</if>
		end;
	</update>

	<insert id="batchInsert">
		declare
		<if test="list!=null and !list.isEmpty()">
			begin
			<foreach collection="list" item="item">
				INSERT into SYS_REGISTER_T
				(
				REG_ID, 
				REG_NAME, 
				REG_CODE,
				REG_DESC,
				PARENT_PATH,
				PARENT_ID,
				ORDER_CODE,
				CREATED_USER,
				CREATED_DATE,
				UPDATE_LAST_USER,
				UPDATE_LAST_DATE,
				VALID_FLAG
				)
				values (
				SYS_REGISTER_S.NEXTVAL,
				#{item.regName,jdbcType=VARCHAR},
				#{item.regCode,jdbcType=VARCHAR},
				#{item.regDesc,jdbcType=VARCHAR},
				#{item.parentPath,jdbcType=VARCHAR},
				#{parentId,jdbcType=INTEGER},
				#{item.orderCode,jdbcType=INTEGER},
				#{item.createdUser,jdbcType=NUMERIC},
				SYSDATE,
				#{item.updateLastUser,jdbcType=NUMERIC},
				SYSDATE,
				1
				);
			</foreach>
			end;
		</if>
	</insert>

</mapper>